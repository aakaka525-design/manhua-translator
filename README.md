# æ¼«ç”»ç¿»è¯‘å™¨ (Manhua Translator)

è‡ªåŠ¨ç¿»è¯‘æ¼«ç”»ä¸­çš„æ–‡å­—ï¼Œæ”¯æŒè‹±æ–‡åˆ°ä¸­æ–‡ç¿»è¯‘ã€‚

![æ•ˆæœç¤ºä¾‹](output/chapter_98_parallel_v1/001_translated.png)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **OCR æ–‡å­—æ£€æµ‹** - ä½¿ç”¨ PaddleOCR v5 æ£€æµ‹æ¼«ç”»ä¸­çš„æ–‡å­—
- **AI ç¿»è¯‘** - ä½¿ç”¨ PPIO GLM API è¿›è¡Œé«˜è´¨é‡ç¿»è¯‘
- **æ™ºèƒ½æ“¦é™¤** - ä½¿ç”¨ LaMa æ¨¡å‹æ“¦é™¤åŸæ–‡
- **è‡ªåŠ¨æ’ç‰ˆ** - åŠ¨æ€å­—å·é€‚é…æ°”æ³¡
- **SFX ä¿ç•™** - æ‹Ÿå£°è¯ï¼ˆå¦‚ BOOMã€MVPï¼‰ä¸ç¿»è¯‘ä¸æ“¦é™¤
- **å¹¶è¡Œå¤„ç†** - å¤šå›¾ç‰‡åŒæ—¶å¤„ç†ï¼Œé€Ÿåº¦æå‡ 4 å€

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### é…ç½® API

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
PPIO_API_KEY=your_api_key_here
PPIO_BASE_URL=https://api.ppio.com/openai
PPIO_MODEL=zai-org/glm-4.7-flash
```

### ä½¿ç”¨æ–¹æ³•

```bash
# ç¿»è¯‘å•å¼ å›¾ç‰‡
python main.py image test.jpg

# ç¿»è¯‘å•å¼ å›¾ç‰‡ï¼ˆæŒ‡å®šè¾“å‡ºç›®å½•ï¼‰
python main.py image test.jpg -o output/

# ç¿»è¯‘æ•´ç« ï¼ˆå¹¶è¡Œå¤„ç†ï¼‰
python main.py chapter input/ output/ -w 3

# å¯åŠ¨ Web æœåŠ¡
python main.py server --port 8000
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| å•å›¾å¤„ç† | ~30s |
| **å¹¶è¡Œå¤„ç†** | **~11s/å¼ ** |
| OCR æ£€æµ‹ | ~4s |
| AI ç¿»è¯‘ | ~16s (æ‰¹é‡) |
| æ“¦é™¤æ¸²æŸ“ | ~12s |

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
manhua/
â”œâ”€â”€ main.py                 # CLI ä¸»å…¥å£
â”œâ”€â”€ batch_translate.py      # å¹¶è¡Œæ‰¹å¤„ç†
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py             # FastAPI æœåŠ¡å…¥å£
â”‚   â”œâ”€â”€ deps.py             # ä¾èµ–æ³¨å…¥ä¸é…ç½®
â”‚   â””â”€â”€ routes/
â”‚       â””â”€â”€ translate.py    # ç¿»è¯‘ API è·¯ç”±
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ pipeline.py         # å¤„ç†æµæ°´çº¿
â”‚   â”œâ”€â”€ ai_translator.py    # AI ç¿»è¯‘å™¨ (PPIO GLM)
â”‚   â”œâ”€â”€ models.py           # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ renderer.py         # æ–‡å­—æ¸²æŸ“
â”‚   â”œâ”€â”€ translator.py       # åŒºåŸŸåˆå¹¶é€»è¾‘
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”œâ”€â”€ ocr.py          # OCR æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ translator.py   # ç¿»è¯‘æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ inpainter.py    # æ“¦é™¤æ¨¡å—
â”‚   â”‚   â””â”€â”€ renderer.py     # æ¸²æŸ“æ¨¡å—
â”‚   â””â”€â”€ vision/
â”‚       â”œâ”€â”€ ocr_engine.py   # PaddleOCR å¼•æ“
â”‚       â””â”€â”€ inpainter.py    # LaMa æ“¦é™¤
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ cli.py              # (åºŸå¼ƒ) æ—§ç‰ˆ CLI
â””â”€â”€ output/                 # è¾“å‡ºç›®å½•
```

## ğŸ”§ å¤„ç†æµç¨‹

```
å›¾ç‰‡ â†’ OCR æ£€æµ‹ â†’ åŒºåŸŸåˆå¹¶ â†’ SFX æ£€æµ‹ â†’ AI ç¿»è¯‘ â†’ æ“¦é™¤ â†’ æ¸²æŸ“ â†’ è¾“å‡º
```

1. **OCR æ£€æµ‹** - PaddleOCR å…¨å›¾æ£€æµ‹æ–‡å­—åŒºåŸŸ
2. **åŒºåŸŸåˆå¹¶** - åˆå¹¶ç›¸é‚»çš„å¯¹è¯è¡Œ
3. **SFX æ£€æµ‹** - è¯†åˆ«æ‹Ÿå£°è¯ï¼ˆè·³è¿‡å¤„ç†ï¼‰
4. **AI ç¿»è¯‘** - PPIO GLM æ‰¹é‡ç¿»è¯‘
5. **æ“¦é™¤** - LaMa æ¨¡å‹æ“¦é™¤åŸæ–‡
6. **æ¸²æŸ“** - åŠ¨æ€å­—å·æ¸²æŸ“ä¸­æ–‡

## ğŸ“ é…ç½®é€‰é¡¹

### ç¿»è¯‘æ¨¡å—

```python
TranslatorModule(
    source_lang="en",     # æºè¯­è¨€
    target_lang="zh-CN",  # ç›®æ ‡è¯­è¨€
    use_ai=True,          # ä½¿ç”¨ AI ç¿»è¯‘
    use_mock=False,       # Mock æ¨¡å¼ï¼ˆæµ‹è¯•ç”¨ï¼‰
)
```

### å¹¶è¡Œå¤„ç†

```python
translate_chapter(
    input_dir,
    output_dir,
    max_concurrent=3,  # å¹¶å‘æ•°ï¼ˆå»ºè®® 2-4ï¼‰
)
```

## ğŸ“„ License

MIT License
